# Profolio Development Scripts

This directory contains automated scripts for development environment setup, validation, and maintenance.

## ğŸš€ **Setup Scripts**

### `setup-dev-environment.sh`

**One-command setup for new team members**

```bash
./scripts/setup-dev-environment.sh
```

**What it does:**

- âœ… Verifies Node.js version (v18.17.0+)
- âœ… Installs/updates pnpm to v9.14.4
- âœ… Installs backend dependencies
- âœ… Generates Prisma client
- âœ… Creates .env from template (if needed)
- âœ… Installs frontend dependencies
- âœ… Verifies TypeScript compilation
- âœ… Checks ESLint configuration
- âœ… Creates validation script

**Usage:**

```bash
# From project root
chmod +x scripts/setup-dev-environment.sh
./scripts/setup-dev-environment.sh
```

### `validate-environment.sh`

**Environment validation and health check**

```bash
./scripts/validate-environment.sh
```

**What it checks:**

- âœ… pnpm version (must be 9.14.4)
- âœ… Backend .env file exists
- âœ… Backend TypeScript compilation
- âœ… Prisma client generation
- âœ… Frontend TypeScript compilation
- âœ… React Hook dependency warnings

**Auto-generated by:** `setup-dev-environment.sh`

## ğŸ”§ **Release Scripts**

### `prepare-release.mjs`

**Automated release preparation and documentation creation**

```bash
node scripts/prepare-release.mjs v1.14.0
```

**What it does:**

- âœ… Updates all package.json files with new version
- âœ… Creates CHANGELOG.md entry template
- âœ… Creates release notes file template in docs/releases/
- âœ… Updates service worker version (PWA cache invalidation)
- âœ… Updates README.md version examples
- âœ… Validates builds (frontend and backend)
- âœ… Creates directory structure for release notes
- âœ… Checks git status and date chronology

**Usage:**

```bash
# Prepare release for v1.14.0
node scripts/prepare-release.mjs v1.14.0

# With or without 'v' prefix
node scripts/prepare-release.mjs 1.14.0

# Show help
node scripts/prepare-release.mjs --help
```

**Output:**
- Creates templates for both CHANGELOG.md and release notes
- Shows next steps for completing the release
- Provides git commands for tagging and pushing

### `validate-release-sync.mjs`

**Release documentation synchronization validator**

```bash
node scripts/validate-release-sync.mjs
```

**What it checks:**

- âœ… Every CHANGELOG.md version has corresponding release notes
- âœ… No orphaned release notes without CHANGELOG entries
- âœ… Dates match between CHANGELOG and release notes
- âœ… docs/releases/README.md shows correct current version
- âœ… Version numbering consistency

**Usage:**

```bash
# Run validation
node scripts/validate-release-sync.mjs

# Should be run before every release
# Exit code 0 = success, 1 = errors found
```

**Common issues detected:**
- Missing release notes for CHANGELOG entries
- Orphaned release notes files
- Date mismatches between documentation
- Outdated current version in docs/releases/README.md

### `check-release-date.sh`

**Release date validation**

Validates release dates and version consistency.

## ğŸ“‹ **Script Usage Guidelines**

### **For New Team Members**

1. Clone the repository
2. Run: `./scripts/setup-dev-environment.sh`
3. Follow the prompts to complete setup
4. Use: `./scripts/validate-environment.sh` anytime to check health

### **For Regular Development**

```bash
# Quick environment check
./scripts/validate-environment.sh

# After pulling changes
pnpm install  # In both backend/ and frontend/
pnpm prisma generate  # In backend/ if schema changed

# Before committing
pnpm run lint          # Fix React Hook warnings
pnpm run type-check    # Fix TypeScript errors
pnpm run build         # Ensure build succeeds
```

### **For Creating Releases**

```bash
# 1. Prepare the release
node scripts/prepare-release.mjs v1.14.0

# 2. Complete the generated templates:
#    - Edit CHANGELOG.md (high-level summary)
#    - Edit docs/releases/v1/v1.14/RELEASE_NOTES_v1.14.0.md (detailed)

# 3. Validate synchronization
node scripts/validate-release-sync.mjs

# 4. Commit and tag
git add -A
git commit -m "feat: v1.14.0 - Brief description"
git tag -a v1.14.0 -m "Release v1.14.0"

# 5. Push to GitHub
git push origin main --tags

# 6. Create GitHub release
gh release create v1.14.0 --title "v1.14.0 - Title" --notes-file docs/releases/v1/v1.14/RELEASE_NOTES_v1.14.0.md
```

### **Troubleshooting**

If any script fails:

1. **Permission Issues**

   ```bash
   chmod +x scripts/*.sh
   ```

2. **pnpm Not Found**

   ```bash
   npm install -g pnpm@9.14.4
   ```

3. **Prisma Issues**

   ```bash
   cd backend && pnpm prisma generate
   ```

4. **Build Issues**
   ```bash
   rm -rf .next node_modules
   pnpm install
   pnpm run build
   ```

## ğŸ” **Expected Output**

### **Successful Setup**

```bash
ğŸš€ Setting up Profolio development environment...
==================================================
âœ… Node.js version v18.17.0 is compatible
âœ… pnpm 9.14.4 is ready
âœ… Backend dependencies installed
âœ… Prisma client generation successful
âœ… Backend TypeScript compilation successful
âœ… Frontend dependencies installed
âœ… Frontend TypeScript compilation successful
âœ… ESLint passes with no warnings

ğŸ‰ Environment validation successful! You're ready to develop.
```

### **Successful Validation**

```bash
ğŸ” Validating Profolio development environment...
âœ… pnpm version correct: 9.14.4
âœ… Backend .env file exists
âœ… Backend TypeScript compilation successful
âœ… Prisma client generation successful
âœ… Frontend TypeScript compilation successful
âœ… No React Hook warnings found

ğŸ‰ Environment validation successful! You're ready to develop.
```

## ğŸš¨ **Common Issues & Solutions**

### **Issue: React Hook Warnings**

```bash
âš ï¸  Found 3 React Hook warnings - run 'pnpm run lint' to see details
```

**Solution:**

```bash
cd frontend
pnpm run lint  # See specific warnings
# Fix missing dependencies in useEffect, useCallback, useMemo
```

### **Issue: Prisma Client Not Generated**

```bash
âŒ Prisma client generation failed
```

**Solution:**

```bash
cd backend
pnpm prisma generate
pnpm run type-check  # Verify fix
```

### **Issue: TypeScript Compilation Failed**

```bash
âŒ Backend TypeScript compilation failed
```

**Solution:**

```bash
# Check for missing environment variables
cat backend/.env

# Ensure all required variables are set:
# - JWT_SECRET
# - API_ENCRYPTION_KEY
# - DATABASE_URL
```

## ğŸ“š **Related Documentation**

- [Team Development Setup Guide](../docs/development/TEAM_DEVELOPMENT_SETUP.md)
- [Package Manager Migration](../docs/development/PACKAGE_MANAGER_MIGRATION.md)
- [Code Quality Checklist](../docs/processes/CODE_QUALITY_CHECKLIST.md)

## ğŸ”„ **Script Maintenance**

### **Adding New Scripts**

1. Create script in `scripts/` directory
2. Make executable: `chmod +x scripts/your-script.sh`
3. Update this README
4. Test thoroughly before committing

### **Updating Existing Scripts**

1. Test changes locally
2. Update version comments in script
3. Update this README if behavior changes
4. Verify with fresh environment

---

**ğŸ’¡ Pro Tip**: Bookmark `./scripts/validate-environment.sh` - run it whenever something feels off with your development environment!
