# Profolio Development Setup

## üèóÔ∏è **Development Workflow**

### **Local Development (Recommended)**

1. **Clone Repository Locally**
   ```bash
   git clone https://github.com/Obednal97/profolio.git
   cd profolio
   ```

2. **Setup Local Environment**
   ```bash
   # Install dependencies
   cd backend && npm install
   cd ../frontend && npm install
   
   # Setup local database (optional - can use mock data)
   docker run --name profolio-dev-db -p 5432:5432 \
     -e POSTGRES_DB=profolio_dev \
     -e POSTGRES_USER=profolio \
     -e POSTGRES_PASSWORD=dev123 \
     -d postgres:15
   ```

3. **Configure Local Environment**
   ```bash
   # Backend .env
   echo 'DATABASE_URL="postgresql://profolio:dev123@localhost:5432/profolio_dev"
   JWT_SECRET="dev-jwt-secret-change-in-production"
   API_KEY_ENCRYPTION_SECRET="dev-encryption-key-change-in-production"
   NODE_ENV=development
   PORT=3001' > backend/.env
   
   # Frontend .env.local (auto-generated by deployment config)
   node deployment.config.js
   ```

4. **Run Development Servers**
   ```bash
   # Terminal 1: Backend
   cd backend && npm run dev
   
   # Terminal 2: Frontend  
   cd frontend && npm run dev
   ```

5. **Access Local App**
   - Frontend: http://localhost:3000
   - Backend API: http://localhost:3001
   - Uses mock data by default (no database needed for UI development)

### **Self-Hosted Production Deployment**

Your current self-hosted setup is good for production, but let's improve it:

#### **Option A: Improved Manual Deployment**
```bash
#!/bin/bash
# deploy.sh - Safer deployment script

set -e  # Exit on any error

echo "üöÄ Deploying Profolio..."

# Backup current version
sudo -u profolio cp -r /opt/profolio /opt/profolio.backup.$(date +%Y%m%d_%H%M%S)

# Stop services
systemctl stop profolio-frontend.service
systemctl stop profolio-backend.service

# Update code (safer approach)
cd /opt/profolio
sudo -u profolio git fetch origin
sudo -u profolio git checkout main
sudo -u profolio git reset --hard origin/main

# Install dependencies & build
cd backend && sudo -u profolio npm ci --production
cd ../frontend && sudo -u profolio npm ci && sudo -u profolio npm run build

# Run database migrations if needed
cd ../backend && sudo -u profolio npx prisma migrate deploy

# Start services
systemctl start profolio-backend.service
systemctl start profolio-frontend.service

# Verify deployment
sleep 5
if curl -f http://localhost:3001/health; then
    echo "‚úÖ Deployment successful!"
    # Clean up old backups (keep last 5)
    ls -t /opt/profolio.backup.* | tail -n +6 | xargs rm -rf
else
    echo "‚ùå Deployment failed - rolling back..."
    systemctl stop profolio-frontend.service profolio-backend.service
    rm -rf /opt/profolio
    mv /opt/profolio.backup.$(date +%Y%m%d_%H%M%S) /opt/profolio
    systemctl start profolio-backend.service profolio-frontend.service
    exit 1
fi
```

#### **Option B: GitHub Actions CI/CD (Recommended)**
```yaml
# .github/workflows/deploy-self-hosted.yml
name: Deploy to Self-Hosted

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: self-hosted  # Use your LXC as a runner
    steps:
      - uses: actions/checkout@v3
      
      - name: Stop Services
        run: |
          systemctl stop profolio-frontend.service
          systemctl stop profolio-backend.service
      
      - name: Install Dependencies
        run: |
          cd backend && npm ci --production
          cd ../frontend && npm ci
      
      - name: Build Frontend
        run: cd frontend && npm run build
      
      - name: Run Migrations
        run: cd backend && npx prisma migrate deploy
      
      - name: Start Services
        run: |
          systemctl start profolio-backend.service
          systemctl start profolio-frontend.service
      
      - name: Health Check
        run: |
          sleep 5
          curl -f http://localhost:3001/health
```

## üéØ **Recommended Development Flow**

### **Day-to-Day Development:**
1. **Work Locally** - Make changes on your local machine
2. **Test Locally** - Verify everything works with `npm run dev`
3. **Create Feature Branch** - `git checkout -b feature/my-feature`
4. **Push to GitHub** - `git push origin feature/my-feature`
5. **Create Pull Request** - Review changes before merging
6. **Merge to Main** - Triggers automatic deployment

### **Benefits of This Approach:**
‚úÖ **Fast Iteration** - No waiting for server deployments to test changes
‚úÖ **Safe Deployments** - Test locally before pushing
‚úÖ **Collaboration** - I can help debug when you're working locally
‚úÖ **Rollback Safety** - Automated backups and health checks
‚úÖ **Professional Workflow** - Matches industry standards

## üîß **Tools You'll Need Locally**

```bash
# Required
node --version  # v18+
npm --version   # v8+
git --version   # v2.30+

# Optional (for database features)
docker --version  # Latest

# Useful
code .  # VS Code for editing
```

## üöÄ **Quick Start (5 minutes)**

```bash
# 1. Clone and setup
git clone https://github.com/Obednal97/profolio.git
cd profolio

# 2. Install everything
npm run install:all  # We should add this script

# 3. Start development
npm run dev:all       # We should add this script

# 4. Open browser
open http://localhost:3000
```

This gives you the **best of both worlds**:
- ‚úÖ Professional local development
- ‚úÖ Self-hosted production deployment
- ‚úÖ Safe, automated deployments
- ‚úÖ Ability for me (Cursor) to help debug 